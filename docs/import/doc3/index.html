<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<title data-react-helmet="true">Unsupervised Learning | AI Lab at CFIA</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Unsupervised Learning | AI Lab at CFIA"><meta data-react-helmet="true" name="description" content="African Swine Fever (ASF) Unsupervised Machine Learning"><meta data-react-helmet="true" property="og:description" content="African Swine Fever (ASF) Unsupervised Machine Learning"><meta data-react-helmet="true" property="og:url" content="https://ai-cfia-docs.github.io/docusaurus/docs/import/doc3"><link data-react-helmet="true" rel="shortcut icon" href="/docusaurus/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://ai-cfia-docs.github.io/docusaurus/docs/import/doc3"><link rel="stylesheet" href="/docusaurus/styles.a93d97cb.css">
<link rel="preload" href="/docusaurus/styles.a14b5d62.js" as="script">
<link rel="preload" href="/docusaurus/runtime~main.3168b6a2.js" as="script">
<link rel="preload" href="/docusaurus/main.1302a5ae.js" as="script">
<link rel="preload" href="/docusaurus/1.86105f2a.js" as="script">
<link rel="preload" href="/docusaurus/2.03b0cb43.js" as="script">
<link rel="preload" href="/docusaurus/43.12553103.js" as="script">
<link rel="preload" href="/docusaurus/44.43390138.js" as="script">
<link rel="preload" href="/docusaurus/64ad76b7.072a52a4.js" as="script">
<link rel="preload" href="/docusaurus/17896441.3a0f8ef4.js" as="script">
<link rel="preload" href="/docusaurus/d40a2c75.b7f99f0a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/docusaurus/"><img class="navbar__logo" src="/docusaurus/img/favicon.ico" alt="My Site Logo"><strong class="navbar__title">Documentation</strong></a><div class="navbar__item dropdown dropdown--hoverable dropdown--left"><a class="navbar__item navbar__link" href="/docusaurus/docs/import/Introduction">Docs</a><ul class="dropdown__menu"><li><a class="dropdown__link" position="left" href="/docusaurus/docs/import/Introduction">Import</a></li><li><a class="dropdown__link" position="left" href="/docusaurus/docs/chatbot/Introduction">Chatbot</a></li><li><a class="dropdown__link" position="left" href="/docusaurus/docs/extractor/Intro">Extractor</a></li><li><a class="dropdown__link" position="left" href="/docusaurus/docs/classification/fish/Intro">Image Classification</a></li></ul></div><a class="navbar__item navbar__link" href="/docusaurus/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2aTZ"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_BsTx">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_BsTx">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/docusaurus/"><img class="navbar__logo" src="/docusaurus/img/favicon.ico" alt="My Site Logo"><strong class="navbar__title">Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="/docusaurus/docs/import/Introduction">Docs</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="left" href="/docusaurus/docs/import/Introduction">Import</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/docusaurus/docs/chatbot/Introduction">Chatbot</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/docusaurus/docs/extractor/Intro">Extractor</a></li><li class="menu__list-item"><a class="menu__link" position="left" href="/docusaurus/docs/classification/fish/Intro">Image Classification</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/docusaurus/blog">Blog</a></li><li class="menu__list-item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Introduction</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docusaurus/docs/import/Introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docusaurus/docs/import/doc1">Prerequisite</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docusaurus/docs/import/doc2">Risk Score</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Setup</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docusaurus/docs/import/doc3">Unsupervised Learning</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docusaurus/docs/import/features">Dash Powered Data Visualization</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docusaurus/docs/import/features2">Features</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Deployment</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docusaurus/docs/import/Deployment">Deployment</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">FAQ</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docusaurus/docs/import/FAQ">FAQ</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Unsupervised Learning</h1></header><div class="markdown"><h1><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="african-swine-fever-asf-unsupervised-machine-learning"></a>African Swine Fever (ASF) Unsupervised Machine Learning<a aria-hidden="true" tabindex="-1" class="hash-link" href="#african-swine-fever-asf-unsupervised-machine-learning" title="Direct link to heading">#</a></h1><p>The main purpose of this project is to detect suspicious shipments based on past import data. As such, this project aims at utlizing unsupervised machine learning techniques on the African Swine Fever (ASF) dataset for meaningful insight extraction and data analysis. </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="data-description"></a>Data Description<a aria-hidden="true" tabindex="-1" class="hash-link" href="#data-description" title="Direct link to heading">#</a></h2><p>The following includes the set of features utilized in our analysis: </p><table><thead><tr><th>Feature Number</th><th>Feature Name</th><th>Feature Type</th></tr></thead><tbody><tr><td>1</td><td>Country of Origin</td><td>Nominal</td></tr><tr><td>2</td><td>Hs-Code</td><td>Nominal</td></tr><tr><td>3</td><td>Port of Entry</td><td>Nominal</td></tr><tr><td>4</td><td>Broker ID</td><td>Nominal</td></tr><tr><td>5</td><td>Business Number</td><td>Nominal</td></tr><tr><td>6</td><td>Vendor</td><td>Nominal</td></tr><tr><td>7</td><td>CFIA Decision Type</td><td>Nominal</td></tr><tr><td>8</td><td>CBSA Decision Type</td><td>Nominal</td></tr><tr><td>9</td><td>Commodity Description</td><td>Text</td></tr><tr><td>10</td><td>Commodity Line Total Price</td><td>Numerical</td></tr><tr><td>11</td><td>Commodity Line Unit Price</td><td>Numerical</td></tr></tbody></table><p>As can be seen from the table above, the import dataset is, for the most part, composed of nominal data. Nominal categorical data are intrinsically unordered. Additionally, and contrary to continuous variables, nominal variables lack any meaningful sense of distance between the different nominal categories. As such, the nature of the prevailing nominal variables in our dataset, in addition to the lack of continuous variables dictate a rather intensive process of feature preprocessing.  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="feature-selection-and-preprocessing"></a>Feature Selection and Preprocessing<a aria-hidden="true" tabindex="-1" class="hash-link" href="#feature-selection-and-preprocessing" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="nominal-variables"></a>Nominal Variables<a aria-hidden="true" tabindex="-1" class="hash-link" href="#nominal-variables" title="Direct link to heading">#</a></h3><p>The approach in <a href="https://www.researchgate.net/publication/278403191_Numerical_Coding_of_Nominal_Data" target="_blank" rel="noopener noreferrer">Numerical Coding of Nominal Data</a> was utilized to extract a meaningful representation of the categorical features in the import dataset. The authors propose a mapping of the nominal data into the complex plane. The mapping takes into account the frequency of categories both by their own merit and relative to that of other categories. Accordingly, and due to the partial ordering inherent to the complex plane, this presentation serves to preserve the lack of order characteristic of nominal data. As such, this approach was used in numerically encoding features 1 through 8 which are of a nominal nature. </p><p>To further enrich the earlier representation, we proposed the introduction of a conditional mapping. This mapping is used to extract information from the dataset conditioning the data based on two factors. </p><ul><li>Time Period (Monthly, Quarterly, Semi-Annually and Annually). </li><li>Groups in other categorical features.
First, the mapping into the complex plane is conditioned over time to extract the changes in a monthly, quarterly, semi-annually and annually manner therefore extracting the representation of each group relative to the different time periods in the data. Second, in order to extract category specific differences (e.g., how the country of origin or a given HS code is distributed with respect to individual brokers), we condition over categories in the features of the dataset itself.
The main rational of the earlier approach is that the distribution of categroies should be inherently different when conditioned on a specific group or time period which would thus enable us to extract more information from our data. Having applied this conditional mapping the seperation in the data is significantly improved. </li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="volume"></a>Volume<a aria-hidden="true" tabindex="-1" class="hash-link" href="#volume" title="Direct link to heading">#</a></h3><p>The volume of the different shipments is reported in different units. As such, we have only isolated the most two frequent units of volume (The number of pieces and weight in KGM). The missing number of pieces for shipments reporting any other units was calculated by dividing the total price by the price per unit. Then an iterative imputer was utilize to find the missing entries for the volume in KGM. The iterative imputer was trained using features () and the numerical encoding of nominal features without the conditional mapping. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="commodity-description"></a>Commodity Description<a aria-hidden="true" tabindex="-1" class="hash-link" href="#commodity-description" title="Direct link to heading">#</a></h3><p>Word embeddings are utilized in preprocessing the commodity description. For reprodusability randomized hashing should be disabled using the following command </p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">PYTHONHASHSEED=random</span></div></div></div></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="pipeline"></a>Pipeline<a aria-hidden="true" tabindex="-1" class="hash-link" href="#pipeline" title="Direct link to heading">#</a></h2><p>Principal Component Analysis (PCA) was used for dimensionality reduction. With the goal of flagging suspicious shiptments, that was followed by the application of two seperate approaches </p><ul><li>Approach 1: Unsupervised Machine Learning (K-Means)
Several runs K-Means were applied at a different number of clusters. This was done with the goal of capturing data falling under two categories: <div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * An (approved) decision type which is grouped together with the (non-approved) instances in the same cluster. </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"> * Small size clusters of (approved) decision type instances. </span></div></div></div></div></div></li></ul><p>The results over a sample dataset are demonstrated in the following figure of the most signicant 3 principal components </p><p> <img src="/img/clustering.png" alt="Test Image 1"></p><ul><li>Approach 2: Noisy Labels
The nominal encoding of features relating to the CFIA and CBSA decision as well as anything conditioned on them is removed. CFIA Decision is treated as a noisy label and a classifier is trained to detect noise in this label (based on the work in <a href="https://github.com/cgnorthcutt/cleanlab" target="_blank" rel="noopener noreferrer">CleanLab</a>).
These two approaches were found to intersect for instances having the same broker in their majority.</li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/import/doc3.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docusaurus/docs/import/doc2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Risk Score</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docusaurus/docs/import/features"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Dash Powered Data Visualization Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#data-description" class="table-of-contents__link">Data Description</a></li><li><a href="#feature-selection-and-preprocessing" class="table-of-contents__link">Feature Selection and Preprocessing</a><ul><li><a href="#nominal-variables" class="table-of-contents__link">Nominal Variables</a></li><li><a href="#volume" class="table-of-contents__link">Volume</a></li><li><a href="#commodity-description" class="table-of-contents__link">Commodity Description</a></li></ul></li><li><a href="#pipeline" class="table-of-contents__link">Pipeline</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docusaurus/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2020 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docusaurus/styles.a14b5d62.js"></script>
<script src="/docusaurus/runtime~main.3168b6a2.js"></script>
<script src="/docusaurus/main.1302a5ae.js"></script>
<script src="/docusaurus/1.86105f2a.js"></script>
<script src="/docusaurus/2.03b0cb43.js"></script>
<script src="/docusaurus/43.12553103.js"></script>
<script src="/docusaurus/44.43390138.js"></script>
<script src="/docusaurus/64ad76b7.072a52a4.js"></script>
<script src="/docusaurus/17896441.3a0f8ef4.js"></script>
<script src="/docusaurus/d40a2c75.b7f99f0a.js"></script>
</body>
</html>